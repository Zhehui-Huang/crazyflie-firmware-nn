
#include "network_evaluate.h"


// attention stuff
static const int D_MODEL = 16;
static const int NUM_TOKENS = 2;
static const float EPS = 0.000001; // 1e-6

static float tokens[NUM_TOKENS][D_MODEL];
static float q_outputs[NUM_TOKENS][D_MODEL];
static float k_outputs[NUM_TOKENS][D_MODEL];
static float v_outputs[NUM_TOKENS][D_MODEL];
static float residual[NUM_TOKENS][D_MODEL];

static float attn_weights[NUM_TOKENS][NUM_TOKENS];
static float softmax_sums[NUM_TOKENS];
static float query_output[NUM_TOKENS][D_MODEL];
static float query_embeds[NUM_TOKENS][D_MODEL];

static float last_layer_means[NUM_TOKENS];
static float last_layer_variances[NUM_TOKENS];
static float attn_embeds[NUM_TOKENS][D_MODEL];

static float neighbor_embeds[NBR_DIM];
static float obstacle_embeds[OBST_DIM];
static float output_embeds[3 * D_MODEL];

float base;
float exponent;


float linear(float num) {
	return num;
}



float sigmoid(float num) {
	return 1 / (1 + exp(-num));
}



float relu(float num) {
	if (num > 0) {
		return num;
	} else {
		return 0;
	}
}

static const int self_structure [3][2] = {{19, 16},{48, 16},{16, 4}};
static const int nbr_structure [1][2] = {{36, 16}};
static const int obst_structure [1][2] = {{9, 16}};
static const int attn_structure [4][2] = {{16, 16},{16, 16}};
static float output_0[16];
static float nbr_output_0[16];
static float obst_output_0[16];
static float output_1[16];
static float output_2[4];
static const float actor_encoder_self_embed_layer_0_weight[19][16] = {{-0.08336841315031052,0.10103808343410492,-0.11789384484291077,-0.050566416233778,-0.23148603737354279,0.6635687947273254,-0.051182691007852554,-0.0416378527879715,0.15496349334716797,0.12763173878192902,0.062055423855781555,0.28566327691078186,-0.139687642455101,0.25480514764785767,-0.08578701317310333,-0.2806602418422699},{-0.1439014971256256,-0.07476282119750977,0.005105273332446814,-0.017171179875731468,-0.21528767049312592,0.19022876024246216,0.08624853193759918,0.22006656229496002,0.3007428050041199,0.04347369074821472,-0.2898317277431488,-0.16748046875,0.16567456722259521,-0.19175010919570923,-0.07408253103494644,-0.41445934772491455},{0.5668020248413086,-0.5805676579475403,0.19413423538208008,0.02518046461045742,-0.06585793942213058,0.3260272443294525,-0.0562010295689106,-0.29056230187416077,0.2742939591407776,-0.6316664814949036,0.13751226663589478,0.0472298189997673,0.43121784925460815,-0.5979971885681152,0.4435509741306305,0.5099937915802002},{0.06683100014925003,0.004655001685023308,0.6465118527412415,0.19963352382183075,0.2687860429286957,-0.07713910192251205,0.3426676392555237,0.2848857641220093,-0.004326540511101484,0.04964302480220795,0.27866730093955994,0.2944382131099701,-0.38416096568107605,-0.02121853083372116,0.08368099480867386,-0.12187779694795609},{-0.019652431830763817,0.2770548164844513,0.29739993810653687,0.39097777009010315,-0.07603871822357178,-0.02504730224609375,-0.4189422130584717,0.0024513909593224525,0.1177980974316597,0.11728150397539139,0.23168344795703888,-0.14115379750728607,0.08897340297698975,0.00041756388964131474,0.4606897234916687,-0.14871549606323242},{0.10287696868181229,-0.160230353474617,0.28377479314804077,-0.057417355477809906,-0.09348073601722717,0.2547505795955658,-0.331464022397995,-0.36694562435150146,0.19866663217544556,-0.3572836220264435,0.07152841985225677,0.11002884060144424,0.34191086888313293,0.1228584423661232,0.18642272055149078,0.20582017302513123},{-0.05103081092238426,0.3473374843597412,0.10964637249708176,0.25320181250572205,-0.2805039882659912,0.010699084959924221,-0.21085046231746674,-0.39198073744773865,0.42160412669181824,0.4772326350212097,-0.38889050483703613,-0.004872486926615238,0.06130408123135567,-0.34387534856796265,-0.4022989273071289,0.036227747797966},{-0.06560688465833664,-0.23050805926322937,0.2707310616970062,0.03276393935084343,0.11702870577573776,-0.24852921068668365,0.32025018334388733,-0.669069230556488,0.3475126028060913,0.2460610270500183,-0.19424688816070557,-0.12752646207809448,0.1781625896692276,-0.24484796822071075,-0.6467506289482117,-0.6687734127044678},{-0.22517551481723785,-0.38040927052497864,0.5309352278709412,0.8676652312278748,0.4179660379886627,0.07836120575666428,0.11308585107326508,0.17713434994220734,0.7018764615058899,-0.16674897074699402,-0.4199390411376953,0.5005173087120056,-0.26657652854919434,0.34180212020874023,0.08672571182250977,0.07502253353595734},{0.15067453682422638,0.15765531361103058,-0.2921370565891266,-0.24091894924640656,-0.11028836667537689,0.5041713118553162,0.07830087095499039,0.5842027068138123,-0.0036600257735699415,0.03213754668831825,-0.09321324527263641,0.14139224588871002,-0.22155512869358063,-0.26682981848716736,-0.1553455889225006,0.26183634996414185},{-0.034016065299510956,-0.18162810802459717,0.23035089671611786,-0.11433683335781097,0.1339855045080185,0.1326828896999359,-0.03046809695661068,-0.28282350301742554,0.26706767082214355,0.2821030616760254,0.18640705943107605,0.3331281542778015,0.3575299382209778,-0.26982957124710083,-0.30110427737236023,-0.25246191024780273},{-0.13721150159835815,0.19532683491706848,-0.08763311803340912,0.45275455713272095,-0.38108110427856445,0.1934124380350113,-0.6633975505828857,-0.29700472950935364,0.14072921872138977,0.09879831969738007,-0.37293100357055664,-0.24993664026260376,-0.05633705481886864,-0.82340008020401,0.6160845160484314,-0.4720020592212677},{-0.5207412242889404,0.17875418066978455,-0.34986963868141174,-0.6181719303131104,-0.6386194825172424,-0.5719333291053772,0.2635776996612549,-0.29758644104003906,-0.7778542637825012,-0.05862773209810257,1.1891061067581177,-0.441281259059906,0.7481253743171692,-0.2537302076816559,-0.3403722643852234,0.1503240019083023},{-0.47326555848121643,-0.8813022971153259,0.6373695135116577,-0.6605812311172485,0.23631325364112854,0.42601457238197327,0.2884443998336792,-0.31825217604637146,0.7214147448539734,-0.08692063391208649,0.5193698406219482,1.1559195518493652,-0.6242995858192444,0.278046190738678,-0.2335236519575119,0.40578901767730713},{-0.13022881746292114,-0.15397968888282776,-0.08368983864784241,0.35398247838020325,0.15462052822113037,-0.1212444007396698,0.06851260364055634,0.21550974249839783,-0.33382484316825867,0.332748681306839,0.3336678147315979,-0.03234870731830597,-0.1281569004058838,0.041329097002744675,-0.23621892929077148,-0.05927499756217003},{0.07515905797481537,-0.1981673240661621,0.1633046716451645,-0.07458676397800446,0.3047921359539032,0.0403628870844841,0.20473501086235046,-0.006958771962672472,0.036368902772665024,0.08284962922334671,0.13300706446170807,0.2193700671195984,0.0036293610464781523,0.3288812041282654,0.014080945402383804,0.1650058776140213},{0.29489678144454956,-0.19312438368797302,0.13154639303684235,0.16024287045001984,0.2864457666873932,0.2638759911060333,0.11620020121335983,0.29068174958229065,0.2744083106517792,0.276437908411026,-0.24366125464439392,-0.1038634404540062,-0.14673371613025665,0.08602717518806458,0.2767644226551056,-0.1457420140504837},{-0.31023749709129333,-0.35572800040245056,-0.2094622105360031,-0.08284527063369751,0.2892632484436035,-0.04712202027440071,-0.3868633806705475,0.33604222536087036,-0.09931216388940811,-0.3256704807281494,-0.03068551979959011,0.3099360466003418,0.01956794038414955,-0.30482396483421326,0.09026846289634705,0.18186435103416443},{-0.03064771741628647,-0.020063428208231926,0.1378697007894516,-0.04927098751068115,-0.38876932859420776,-0.3199615478515625,0.005006100982427597,0.00540572963654995,0.38433900475502014,-0.1878805309534073,-0.17436698079109192,0.04247359186410904,0.034988660365343094,0.26467856764793396,0.09970963001251221,-0.17050151526927948}};
static const float actor_encoder_feed_forward_0_weight[48][16] = {{-0.05203791335225105,0.1768493354320526,0.15053711831569672,0.40510910749435425,0.19901643693447113,0.003777551231905818,-0.2144024670124054,-0.1175655871629715,0.3022346794605255,-0.10343531519174576,0.04681578651070595,-0.3331827223300934,-0.016981858760118484,-0.027668889611959457,0.204429492354393,-0.16598562896251678},{-0.07036198675632477,-0.20586824417114258,0.02958797663450241,-0.21907109022140503,-0.27097418904304504,0.08376677334308624,-0.11369474977254868,0.14373870193958282,0.42083486914634705,0.22678497433662415,-0.16447089612483978,-0.24230174720287323,-0.32000070810317993,0.2735125422477722,-0.027407631278038025,-0.15150076150894165},{0.148347869515419,-0.20190441608428955,-0.28584718704223633,-0.2290688157081604,-0.028764544054865837,-0.009117507375776768,-0.008917386643588543,0.014027372002601624,-0.13333405554294586,0.15292060375213623,0.40862810611724854,-0.1756639927625656,0.33279019594192505,-0.224868044257164,0.007625213824212551,-0.13356824219226837},{0.11060314625501633,-0.3088192641735077,-0.1361495852470398,-0.12555676698684692,0.18401502072811127,0.4164917469024658,-0.06456716358661652,-0.26591676473617554,0.06442735344171524,0.3704260289669037,0.07804757356643677,-0.1904730647802353,-0.04324755817651749,-0.39190998673439026,0.06810890883207321,-0.06345970928668976},{-0.0002697401796467602,0.05778511241078377,-0.16853050887584686,0.33132874965667725,-0.34109264612197876,-0.05641952529549599,0.19605854153633118,0.07277712225914001,-0.014412954449653625,-0.005884015001356602,-0.214421346783638,0.2629293203353882,0.0452999472618103,0.05982983112335205,0.266102135181427,0.1263687163591385},{0.0703204944729805,0.16910810768604279,-0.2426636666059494,-0.15613752603530884,-0.09747914969921112,0.003255183342844248,0.14714090526103973,0.042121220380067825,-0.2445276379585266,-0.36156266927719116,-0.2075023353099823,-0.2833031415939331,0.28410542011260986,-0.3442257046699524,0.22956997156143188,0.14316530525684357},{-0.0770278349518776,0.02600426971912384,0.008310065604746342,0.2529553174972534,-0.17194248735904694,-0.09984364360570908,0.22825421392917633,0.135696679353714,-0.12048456817865372,0.18024565279483795,0.15860608220100403,-0.05677921324968338,0.2046547532081604,0.1037498265504837,0.18313367664813995,-0.31887245178222656},{-0.19313372671604156,0.22667458653450012,-0.10287949442863464,-0.5190341472625732,-0.330861359834671,0.25036564469337463,-0.27170896530151367,0.10910755395889282,-0.05830443277955055,-0.2884860932826996,0.16895844042301178,0.4228931963443756,-0.28777486085891724,0.14599670469760895,0.3079517185688019,0.3504946827888489},{-0.17963287234306335,-0.1872984617948532,-0.25440773367881775,0.22614961862564087,0.08190840482711792,-0.18974290788173676,-0.2995757758617401,-0.1672169268131256,-0.017273519188165665,0.13222888112068176,0.28742414712905884,-0.17908522486686707,0.4180079996585846,-0.16482646763324738,-0.13036629557609558,0.04617220535874367},{0.3479315936565399,-0.010693772695958614,0.13548924028873444,0.18330030143260956,-0.2529459297657013,-0.17170433700084686,0.34282386302948,0.17455683648586273,0.3740951716899872,0.48853522539138794,0.10167353600263596,0.0036851242184638977,-0.3074834644794464,0.2508346140384674,0.08220453560352325,-0.1115698590874672},{-0.1311175674200058,0.46338653564453125,0.08915869891643524,-0.04305901750922203,0.08415361493825912,-0.018559565767645836,0.11151161789894104,-0.05731388181447983,0.14040778577327728,0.1694965362548828,-0.06663772463798523,0.04430755227804184,0.07495884597301483,0.1332835704088211,-0.25171852111816406,0.11622866988182068},{-0.26884910464286804,0.06998312473297119,-0.07718127220869064,-0.27768832445144653,-0.009512519463896751,-0.024935416877269745,-0.21889926493167877,-0.37394341826438904,0.32214418053627014,0.20096948742866516,0.4807957410812378,-0.11046934872865677,0.06455763429403305,-0.25209882855415344,0.05179085209965706,-0.0497019998729229},{0.22584989666938782,0.29686790704727173,-0.02504292130470276,-0.20750920474529266,0.2287265956401825,0.030581273138523102,-0.14514151215553284,0.23534324765205383,-0.14825406670570374,0.26368650794029236,0.25650516152381897,-0.2176031768321991,-0.03665124624967575,0.14332470297813416,-0.22730764746665955,-0.016834668815135956},{-0.1897323876619339,-0.04607347026467323,0.315692275762558,0.016789760440587997,0.029885241761803627,0.01881582848727703,0.400162011384964,-0.24105744063854218,0.3035099506378174,-0.08956944942474365,-0.21975663304328918,0.20544517040252686,0.2894778549671173,0.014410180039703846,-0.016954850405454636,0.027100633829832077},{0.26236018538475037,0.27209264039993286,-0.20183779299259186,-0.11166666448116302,-0.26860037446022034,-0.026090728119015694,-0.15258949995040894,-0.1470857858657837,-0.06296588480472565,-0.2099364697933197,-0.3061939477920532,-0.11434239894151688,0.11651797592639923,-0.25725245475769043,-0.2639358341693878,0.43472883105278015},{-0.30237624049186707,0.4260643422603607,-0.41341161727905273,-0.24387440085411072,0.3944315016269684,-0.09420636296272278,0.17247088253498077,0.11749564856290817,-0.10641621798276901,-0.1072547435760498,-0.16610614955425262,0.14439809322357178,0.10647378861904144,-0.0013756846310570836,-0.03148564696311951,0.3427579402923584},{0.21834827959537506,0.09990105032920837,-0.2335515022277832,0.12417494505643845,0.13199178874492645,-0.08151689171791077,-0.007018941454589367,0.1557336449623108,0.004830139223486185,-0.03306267410516739,-0.1198885515332222,0.11516189575195312,0.14602048695087433,-0.26223069429397583,0.11615188419818878,-0.13191893696784973},{0.1289067268371582,0.03647293522953987,0.03636688366532326,0.039215367287397385,-0.0699017122387886,-0.015492766164243221,0.0012710941955447197,0.13652494549751282,-0.045059867203235626,-0.23767079412937164,-0.10863051563501358,0.024828583002090454,0.24800743162631989,0.17425262928009033,0.09145303815603256,0.03212418779730797},{0.03055015578866005,0.02201073244214058,0.1789250373840332,-0.21797175705432892,0.10483101010322571,0.03319874033331871,0.23006168007850647,-0.172139972448349,-0.12605030834674835,0.28246787190437317,-0.19479691982269287,0.04997943341732025,0.049791332334280014,-0.22125251591205597,-0.031079262495040894,0.27677106857299805},{0.0035020869690924883,-0.17738798260688782,-0.22608715295791626,-0.010783977806568146,-0.151455357670784,-0.005713587626814842,-0.1822487860918045,-0.28025346994400024,0.1954108029603958,-0.12183216959238052,-0.005888770800083876,-0.052227675914764404,-0.09821362793445587,0.2518368065357208,0.053536850959062576,0.017824916169047356},{0.09038331359624863,-0.1892016977071762,-0.07947532832622528,-0.149721160531044,0.20135639607906342,0.18149065971374512,0.09250017255544662,0.13658317923545837,-0.03187843784689903,-0.2619662284851074,0.1423555463552475,-0.0013803447363898158,-0.028942570090293884,0.11186637729406357,0.30468976497650146,5.5399643315467983e-05},{0.10427681356668472,-0.04114985838532448,-0.178852841258049,0.25641652941703796,-0.18505612015724182,0.03075476735830307,-0.1267300546169281,-0.11905979365110397,0.13734488189220428,-0.11383052170276642,-0.06584616005420685,0.06385472416877747,0.13947826623916626,0.19618207216262817,0.0605667307972908,0.0011271456023678184},{-0.024586310610175133,-0.0506884790956974,-0.006402033381164074,-0.04498852416872978,0.11787647753953934,0.06222471222281456,-0.07194701582193375,-0.012559015303850174,0.32325324416160583,-0.11544922739267349,-0.020888620987534523,0.02859555371105671,0.15697799623012543,0.2033875435590744,0.2942188084125519,0.032646894454956055},{-0.07726401090621948,0.12490911781787872,0.12454862147569656,0.24295508861541748,-0.20964644849300385,-0.05500705540180206,-0.26425984501838684,0.24034364521503448,0.21641980111598969,0.0655265748500824,-0.05862666666507721,0.02773473411798477,0.23482860624790192,-0.19666814804077148,0.30150049924850464,0.20140177011489868},{0.05824902281165123,-0.20288819074630737,0.11706048250198364,0.19969865679740906,-0.03638950362801552,0.13106206059455872,-0.0035923304967582226,-0.07575397193431854,0.07960015535354614,0.004740444011986256,-0.06604838371276855,0.12479545176029205,-0.009748583659529686,0.09025267511606216,0.17749541997909546,-0.07014352083206177},{0.1266600638628006,0.08154791593551636,-0.2212754487991333,-0.17592671513557434,0.15091313421726227,0.13847602903842926,-0.15215638279914856,-0.1524798423051834,0.1716836839914322,-0.06673330813646317,-0.004880364052951336,-0.06522917002439499,0.2609255611896515,0.11920091509819031,0.012143830768764019,-0.1597013771533966},{-0.10816067457199097,-0.10621316730976105,0.12698955833911896,0.15972314774990082,0.13114404678344727,0.12269623577594757,-0.062188856303691864,-0.0617547370493412,-0.21933923661708832,-0.2839367985725403,-0.03313365578651428,-0.14164456725120544,-0.19748356938362122,0.015454483218491077,0.15733656287193298,-0.12615825235843658},{0.09346970170736313,0.2250642627477646,0.052630677819252014,-0.13618263602256775,-0.07581476867198944,-0.08250268548727036,0.01758113130927086,0.05073675513267517,-0.02859075926244259,0.15075591206550598,-0.2667233645915985,-0.1792050302028656,0.1349843293428421,0.06442565470933914,0.15738068521022797,0.11412394046783447},{0.23681743443012238,0.036796897649765015,-0.2767447233200073,-0.2620498538017273,0.20958970487117767,0.10522321611642838,0.06340411305427551,-0.07321790605783463,0.24221068620681763,-0.020868511870503426,0.11467564851045609,-0.1106383353471756,0.20785267651081085,0.20779921114444733,0.054640017449855804,-0.07140467315912247},{0.08067783713340759,-0.17475084960460663,0.09724079817533493,0.13440702855587006,-0.009501402266323566,-0.005520966369658709,-0.18444132804870605,0.22820888459682465,0.05374842509627342,-0.12767040729522705,-0.09123627841472626,0.19737780094146729,0.07317068427801132,-0.13541507720947266,0.24152269959449768,-0.23587846755981445},{-0.020531954243779182,0.026498524472117424,0.26245933771133423,-0.0637047290802002,0.11802507936954498,-0.07397519052028656,-0.10054157674312592,-0.2000354379415512,0.08361286669969559,0.013274316675961018,-0.32608070969581604,0.014500880613923073,0.18240106105804443,-0.30901390314102173,-0.08590472489595413,-0.03498762473464012},{0.2814265191555023,-0.15980204939842224,-0.07683919370174408,-0.3005492687225342,-0.24130015075206757,-0.015495064668357372,-0.09657371044158936,0.054591502994298935,0.16494052112102509,0.19611205160617828,0.21421197056770325,0.29683423042297363,0.18297435343265533,0.1280629187822342,-0.05923039838671684,-0.029844051226973534},{0.04051123186945915,-0.29201820492744446,0.040847666561603546,-0.15946070849895477,0.05893997848033905,-0.24833253026008606,-0.20274275541305542,0.17481252551078796,0.010911911725997925,-0.04105588421225548,0.0011404284741729498,0.13250847160816193,-0.23040762543678284,0.24988268315792084,0.07029230892658234,0.03411976248025894},{0.2505389451980591,0.06721986830234528,-0.01592515967786312,-0.21224723756313324,-0.01653105579316616,0.11867069453001022,0.11638504266738892,0.179924875497818,0.055391814559698105,0.08592156320810318,0.06013854593038559,-0.10707584768533707,0.17456182837486267,0.04556141793727875,-0.09145699441432953,-0.03165999427437782},{-0.2479674071073532,-0.13483238220214844,0.18035146594047546,-0.17586542665958405,0.279023140668869,0.1787879317998886,0.12022610753774643,-0.18587127327919006,-0.18767903745174408,0.03418751433491707,-0.003126842435449362,0.1844051331281662,0.151301309466362,-0.053781602531671524,-0.2007429599761963,0.2333494871854782},{-0.06569566577672958,0.23669634759426117,0.044938184320926666,-0.03735627606511116,0.16204525530338287,-0.11879514902830124,0.038557976484298706,0.06467923521995544,-0.27556928992271423,-0.13416887819766998,0.3111720085144043,0.025218484923243523,0.11725389957427979,-0.14024588465690613,0.13437406718730927,-0.30305564403533936},{-0.22202058136463165,0.13421675562858582,-0.1762544810771942,-0.2030370682477951,0.12055165320634842,0.15941482782363892,-0.2243184894323349,-0.09816591441631317,0.10289152711629868,0.2909078598022461,-0.2553386390209198,-0.2324923425912857,0.20156553387641907,0.025618119165301323,0.08339148014783859,-0.3351341784000397},{0.1918373703956604,-0.3923581838607788,-0.07327276468276978,-0.041733983904123306,0.19173738360404968,-0.07578490674495697,-0.14843477308750153,-0.16776655614376068,0.25570374727249146,0.18766433000564575,-0.1270866096019745,0.1139225885272026,0.045339420437812805,-0.4095410406589508,0.16808581352233887,0.3002279996871948},{0.19972582161426544,0.23465265333652496,0.13224148750305176,0.22497238218784332,-0.17597050964832306,0.1511216014623642,-0.2573506534099579,-0.012028155848383904,0.15276433527469635,0.02785084769129753,-0.13641269505023956,-0.11073486506938934,0.06005578488111496,-0.0954345092177391,-0.023559803143143654,-0.2130572497844696},{0.212764710187912,-0.11272913962602615,0.030017323791980743,-0.2646341323852539,-0.18005609512329102,-0.380657434463501,-0.22108101844787598,0.2543705403804779,0.2006334364414215,0.1943257749080658,-0.1805679053068161,-0.09705287963151932,0.1770402491092682,0.1582769751548767,0.06959401816129684,0.15496781468391418},{-0.06545208394527435,0.12643153965473175,0.09417077898979187,0.09069875627756119,0.1644473522901535,-0.17182597517967224,-0.09072085469961166,0.12491235136985779,-0.2634757161140442,-0.04417986795306206,0.24810659885406494,-0.20084963738918304,-0.29645687341690063,0.05010497570037842,0.13331249356269836,0.154352068901062},{0.08424083143472672,0.062122829258441925,0.0994488000869751,0.41332513093948364,0.00924495980143547,0.02927916869521141,0.050422318279743195,-0.15653842687606812,0.14487268030643463,-0.11986997723579407,-0.35098108649253845,0.08351404964923859,-0.2752814292907715,-0.193827286362648,-0.12783120572566986,-0.02376140095293522},{-0.04232429713010788,0.017001677304506302,0.053655240684747696,-0.09764346480369568,0.0005715226870961487,-0.047865234315395355,-0.1217009499669075,0.04716096445918083,-0.35500839352607727,0.08706879615783691,-0.06637716293334961,0.32534268498420715,0.31494536995887756,-0.10084395855665207,0.14344075322151184,-0.23447908461093903},{-0.09997382014989853,-0.14721772074699402,0.29761582612991333,0.033846184611320496,-0.19264192879199982,0.10393987596035004,-0.2573833465576172,0.0519394613802433,-0.09864863008260727,-0.2521565556526184,0.10398687422275543,0.29608720541000366,0.32005834579467773,0.24684832990169525,-0.010396945290267467,-0.06667117029428482},{0.21622835099697113,-0.01784292422235012,-0.1842135787010193,-0.2971510887145996,0.014965634793043137,-0.18233643472194672,0.15487152338027954,0.12569330632686615,0.043849363923072815,-0.061437055468559265,0.37245672941207886,-0.1172841414809227,-0.08783293515443802,-0.16606222093105316,0.2218603640794754,-0.13103929162025452},{0.27946600317955017,0.06324473023414612,0.20686741173267365,0.2060101181268692,-0.04206593334674835,0.20678798854351044,0.18914607167243958,-0.01961902715265751,0.2944192588329315,-0.1714121550321579,-0.25239530205726624,-0.16476234793663025,0.19160567224025726,-0.13112708926200867,0.2592422068119049,0.2672903835773468},{0.09775036573410034,0.0077718570828437805,-0.23111945390701294,0.19076044857501984,0.04468012601137161,0.18944434821605682,0.01994936354458332,-0.1771739274263382,0.05638405680656433,0.012138107791543007,0.43019208312034607,0.12872250378131866,0.07967988401651382,-0.25902125239372253,0.1230197325348854,0.02543479949235916},{-0.03171740472316742,0.14043766260147095,-0.17743194103240967,-0.007086766883730888,0.10973009467124939,0.1021583080291748,0.0012320475652813911,0.07859976589679718,0.21410423517227173,-0.016660017892718315,-0.1383351981639862,-0.21059267222881317,0.08592015504837036,0.17865383625030518,-0.10397906601428986,0.1318024843931198}};
static const float action_parameterization_distribution_linear_weight[16][4] = {{-0.14216722548007965,-0.2390424907207489,0.13103865087032318,0.21517036855220795},{0.1638888269662857,-0.11188503354787827,0.06272175163030624,-0.3388960659503937},{-0.25304320454597473,0.29619285464286804,0.2580908238887787,0.08693873882293701},{-0.3484375774860382,0.18829870223999023,-0.29264265298843384,0.14995546638965607},{-0.304799348115921,-0.08692631870508194,-0.008720163255929947,-0.28608134388923645},{0.36958327889442444,-0.39208677411079407,-0.019342388957738876,0.34279128909111023},{0.1482272893190384,0.2769896686077118,-0.1466204971075058,0.1410965919494629},{-0.15048034489154816,-0.010385362431406975,0.06648392975330353,-0.07048602402210236},{-0.1221594363451004,-0.10730264335870743,0.18266452848911285,0.11863198131322861},{0.34133264422416687,0.4687936007976532,0.08443447202444077,0.33922722935676575},{0.09921348839998245,0.2620956301689148,-0.23318876326084137,-0.32770857214927673},{0.5293935537338257,0.13552126288414001,0.3249683976173401,-0.19591040909290314},{-0.08738317340612411,0.09454413503408432,-0.29310837388038635,-0.08045834302902222},{-0.05045436695218086,0.14981333911418915,0.21481585502624512,-0.08589279651641846},{0.2823733687400818,-0.005063828080892563,-0.03420798480510712,0.10274562239646912},{0.005467571318149567,-0.18168415129184723,0.10778234899044037,-0.10169518738985062}};
static const float actor_encoder_self_embed_layer_0_bias[16] = {0.06800602376461029,0.08646683394908905,0.040802743285894394,-0.07290275394916534,-0.07986713200807571,0.17114755511283875,0.08570832014083862,-0.09030938148498535,0.0342046283185482,-0.010798409581184387,-0.06544462591409683,0.10642169415950775,0.002339606173336506,-0.017967017367482185,0.10647814720869064,0.05876922234892845};
static const float actor_encoder_feed_forward_0_bias[16] = {0.0030536095146089792,0.0018195860320702195,-0.02909541316330433,-0.10358033329248428,-0.022310152649879456,0.0018832491477951407,-0.006088036112487316,-0.013469802215695381,0.09947864711284637,0.035989534109830856,0.04553942754864693,-0.014849301427602768,-0.062051694840192795,-0.030068177729845047,0.05379598215222359,0.057507146149873734};
static const float action_parameterization_distribution_linear_bias[4] = {0.016919445246458054,-0.021656209602952003,0.06870117783546448,0.01397206261754036};
static const float actor_encoder_neighbor_embed_layer_0_weight[36][16] = {{0.13815359771251678,-0.2740442454814911,0.179448202252388,-0.026888513937592506,0.31714674830436707,0.07281607389450073,0.33170875906944275,0.493903785943985,0.2594805061817169,0.29128313064575195,-0.19284884631633759,-0.37661212682724,-0.272604763507843,0.07515030354261398,0.09031857550144196,-0.026585597544908524},{-0.0933736264705658,-0.08147778362035751,-0.06278789788484573,-0.09654416143894196,0.33493828773498535,0.2837187647819519,-0.35179510712623596,-0.28501448035240173,-0.18472182750701904,0.3104017674922943,-0.12656010687351227,-0.46857741475105286,0.3179861903190613,0.3364577293395996,0.3648812472820282,0.14501994848251343},{0.8248436450958252,0.3290019631385803,-0.39724743366241455,-0.712611198425293,0.08053940534591675,-0.1691834181547165,0.2570154070854187,0.5208645462989807,-0.1715165078639984,0.667650043964386,0.31096434593200684,0.11878085881471634,0.32438555359840393,-0.28602829575538635,0.4141778349876404,-0.5492808818817139},{-0.13125471770763397,0.14632220566272736,-0.23041293025016785,-0.45483267307281494,0.08649615198373795,-0.13419309258460999,0.16845442354679108,-0.1511351466178894,-0.1035967692732811,-0.008440165780484676,-0.024421438574790955,-0.13369859755039215,-0.03625379130244255,-0.32152068614959717,-0.07087249308824539,0.3302798271179199},{-0.4625742733478546,0.23883473873138428,-0.3801637887954712,0.4251689910888672,-0.3327193558216095,-0.15338313579559326,-0.17839056253433228,-0.05967153608798981,0.1437537521123886,-0.279860258102417,-0.2737048268318176,-0.017249954864382744,-0.5029774904251099,0.49221354722976685,-0.38851600885391235,0.19090856611728668},{-0.17605383694171906,0.3230145275592804,-0.1562889814376831,-0.0008465989376418293,-0.10934038460254669,0.4008563458919525,-0.14172689616680145,-0.29163244366645813,0.1651918590068817,-0.17867878079414368,0.1141141951084137,0.05367100238800049,-0.01759769581258297,0.08062165975570679,0.18735766410827637,0.3682430386543274},{-0.10720847547054291,0.21992576122283936,0.2427147775888443,0.3124561607837677,0.035430535674095154,0.0002055453514913097,0.14066936075687408,0.1203666403889656,-0.10324972122907639,0.3780340552330017,0.054301146417856216,-0.3710031509399414,-0.2289968878030777,0.17245273292064667,-0.17092739045619965,0.10267804563045502},{-0.035387247800827026,-0.06317919492721558,0.4326605498790741,0.058934349566698074,0.058882638812065125,-0.0026188460178673267,-0.03312487155199051,-0.12580130994319916,-0.207706481218338,-0.27082210779190063,0.12134566903114319,-0.31769540905952454,0.16514411568641663,0.24886657297611237,0.03522757813334465,-0.056098368018865585},{0.0007967653218656778,-0.1874466836452484,-0.2296781986951828,-0.14514638483524323,0.2903575897216797,-0.3748013973236084,0.2906858026981354,0.23156574368476868,0.04636836051940918,0.3757566809654236,0.4685252904891968,-0.3861091732978821,0.049822237342596054,-0.06598258763551712,-0.3529115319252014,-0.041541945189237595},{-0.15489234030246735,-0.23021531105041504,-0.42594045400619507,0.20352573692798615,0.13786667585372925,0.1287202388048172,0.2640206217765808,0.08278020471334457,-0.1395719051361084,0.44974392652511597,-0.19716614484786987,0.0058571407571434975,-0.1542978286743164,0.29674312472343445,0.14293333888053894,-0.17124098539352417},{-0.2836587131023407,-0.2789336144924164,0.25543612241744995,-0.021804368123412132,0.20516271889209747,-0.2695220708847046,-0.004098116885870695,-0.27661213278770447,-0.2168642282485962,-0.25625523924827576,-0.08256270736455917,-0.16788412630558014,0.043886084109544754,0.077034130692482,-0.054670482873916626,0.2989794611930847},{0.3036661148071289,0.3273697793483734,-0.2501741647720337,0.19408558309078217,0.05066300183534622,-0.10482015460729599,0.24778732657432556,0.04288492351770401,-0.223248690366745,-0.19429194927215576,-0.081673763692379,0.234977588057518,0.34281954169273376,0.10473139584064484,0.2831079959869385,0.33038896322250366},{0.11970429122447968,0.004902292508631945,-0.015736237168312073,0.09801238030195236,-0.001266489620320499,-0.23552943766117096,-0.10126034915447235,0.26895377039909363,0.2178511917591095,0.07228744775056839,-0.19149121642112732,0.19446054100990295,0.23624679446220398,0.0674397200345993,0.032980743795633316,-0.17157979309558868},{-0.1310713142156601,-0.1782139539718628,0.15270616114139557,-0.3258619010448456,0.2980331778526306,0.16491717100143433,-0.08289121091365814,-0.21329769492149353,0.1421211212873459,-0.21125760674476624,0.2623501121997833,0.3058750629425049,0.008986115455627441,0.04023532196879387,-0.20708592236042023,-0.23020340502262115},{0.3910517692565918,0.12172132730484009,0.35594987869262695,0.12021905183792114,-0.35957950353622437,0.04064702242612839,-0.3010212481021881,0.09408155828714371,-0.1227962076663971,-0.0986834242939949,-0.02893863245844841,-0.2526654899120331,0.1566813439130783,-0.10964402556419373,0.3550735116004944,0.17678740620613098},{-0.10582172125577927,-0.3181556165218353,0.09389472007751465,-0.4400181174278259,-0.31948840618133545,-0.029194150120019913,0.09567606449127197,-0.19985412061214447,0.18345125019550323,-0.04235110804438591,-0.22373950481414795,-0.21544232964515686,0.34611013531684875,-0.33395910263061523,-0.30239415168762207,0.1887509524822235},{-0.14450955390930176,0.17148157954216003,-0.02251124009490013,-0.10067446529865265,0.3723689913749695,-0.24879568815231323,-0.19359615445137024,0.255333811044693,0.007241935934871435,-0.042710255831480026,0.4457785487174988,0.20337535440921783,-0.3243316411972046,0.08219310641288757,-0.29092347621917725,0.00366932968609035},{-0.04322711005806923,0.23154979944229126,-0.001674415310844779,-0.07886675745248795,0.2081354707479477,0.009520722553133965,-0.14970345795154572,0.15053531527519226,-0.20584678649902344,-0.022469142451882362,0.35464757680892944,0.24600309133529663,0.14968501031398773,0.43864163756370544,0.08997191488742828,-0.09132128953933716},{-0.20110607147216797,0.245561882853508,0.10280771553516388,-0.02269838936626911,0.08362346887588501,-0.049007005989551544,-0.21818993985652924,-0.1351606696844101,0.10940360277891159,-0.016728399321436882,-0.2201584279537201,-0.08342165499925613,0.06610697507858276,0.1142948716878891,-0.13535095751285553,-0.09444233030080795},{0.25174185633659363,-0.19935256242752075,0.15016572177410126,-0.08458594232797623,0.00026830300339497626,-0.15595971047878265,0.06744735687971115,-0.297858864068985,0.12900833785533905,-0.1640726774930954,0.016487371176481247,0.3326950967311859,0.22971902787685394,-0.08787482231855392,0.10511323064565659,0.05817212909460068},{0.12375690788030624,0.08577677607536316,-0.2836989760398865,0.17656438052654266,-0.12464746832847595,0.06038564071059227,-0.17959731817245483,0.38691914081573486,-0.010189146734774113,0.3900361657142639,0.3222779929637909,-0.22010129690170288,0.1372080296278,0.09529133141040802,0.18029585480690002,0.15498502552509308},{-0.3448374271392822,-0.2631888687610626,-0.3137151598930359,-0.1336190104484558,0.07887274026870728,0.10262537747621536,-0.259409636259079,0.38466575741767883,0.4286196231842041,0.05667347460985184,-0.00048294125008396804,0.3393472731113434,0.1332685500383377,-0.09633548557758331,0.07585254311561584,-0.07195209711790085},{0.3129982054233551,-0.3597019910812378,0.07060384750366211,0.10631871223449707,-0.1754249632358551,0.08490615338087082,-0.4096396863460541,-0.2649521827697754,0.26669391989707947,0.16059482097625732,-0.12769050896167755,-0.21254359185695648,0.1540290266275406,0.014006130397319794,-0.2655393183231354,0.11069203913211823},{-0.09417892247438431,0.3509470224380493,-0.330986887216568,0.27321958541870117,0.360573947429657,-0.20066028833389282,-0.26040560007095337,0.09464148432016373,-0.18119782209396362,-0.07059095054864883,-0.028959356248378754,0.11854105442762375,0.0811273530125618,-0.10270432382822037,0.08511748164892197,0.23989605903625488},{0.14080548286437988,-0.08378542214632034,0.0982222855091095,0.18916304409503937,0.2938031554222107,-0.2440510243177414,0.1801227629184723,-0.008130894973874092,0.36219650506973267,-0.11162285506725311,-0.17179229855537415,-0.05388255789875984,0.017091911286115646,0.07485580444335938,-0.038457371294498444,-0.12943755090236664},{-0.029484257102012634,0.20230311155319214,0.18650659918785095,0.05711761862039566,-0.15463045239448547,0.09810758382081985,-0.07702229917049408,0.14132289588451385,0.34895336627960205,0.06850364059209824,0.14010901749134064,-0.3163333237171173,0.3358061611652374,-0.0521223284304142,0.1341799944639206,0.04076750576496124},{-0.13000307977199554,0.010100463405251503,0.193897545337677,-0.2957260012626648,0.19508153200149536,-0.04402840882539749,-0.04737323150038719,0.07702983170747757,-0.15895280241966248,0.27245596051216125,-0.04732712730765343,0.048035793006420135,0.35274356603622437,0.13167932629585266,-0.036628950387239456,-0.14706376194953918},{0.02331625483930111,0.012735472060739994,0.1554258167743683,-0.45079246163368225,-0.20239567756652832,-0.11695419251918793,0.029392346739768982,0.30125361680984497,-0.10306216776371002,0.29310306906700134,-0.3487831950187683,-0.15108618140220642,-0.1382189393043518,0.32210060954093933,-0.18341068923473358,0.37345969676971436},{0.016949735581874847,0.07719586789608002,0.005856968928128481,-0.3926807641983032,-0.21721100807189941,0.15170183777809143,-0.21535803377628326,0.28824856877326965,-0.1677774041891098,-0.36609286069869995,0.4619869589805603,0.06861139833927155,0.30644309520721436,0.18166427314281464,-0.203297421336174,0.2724185585975647},{-0.41944465041160583,0.20383551716804504,0.06763775646686554,-0.31254008412361145,0.07725746184587479,0.031233878806233406,0.02959093265235424,0.2656262218952179,-0.09738951921463013,-0.11869368702173233,0.27058395743370056,4.106694177608006e-05,-0.01887129619717598,-0.023829957470297813,0.07711717486381531,0.02621205896139145},{0.15213221311569214,0.25257423520088196,0.13914890587329865,-0.16627871990203857,-0.0017291781259700656,-0.18660090863704681,0.26636871695518494,-2.733475048444234e-05,0.018976135179400444,0.15262849628925323,-0.12871964275836945,-0.03480694815516472,0.021207595244050026,0.3864998519420624,-0.42407965660095215,-0.143677219748497},{-0.216429203748703,-0.12791188061237335,0.028363101184368134,-0.11142489314079285,0.27612292766571045,-0.0007059627678245306,0.12845134735107422,0.0317133404314518,0.1410563588142395,0.06299464404582977,0.06675630807876587,-0.060496289283037186,0.2944067716598511,-0.020955346524715424,0.010094694793224335,-0.13628320395946503},{0.025713982060551643,0.27915677428245544,-0.22989295423030853,0.2256041318178177,-0.06215183809399605,-0.2378477156162262,-0.02191690355539322,0.2041570395231247,0.17972682416439056,0.3801691234111786,0.12335389107465744,-0.0151388393715024,-0.050047021359205246,-0.07863488793373108,-0.21053503453731537,-0.26750707626342773},{-0.0068582952953875065,0.17661914229393005,0.12711606919765472,-0.48290565609931946,-0.1260688453912735,-0.08279319852590561,0.2888418436050415,-0.09564099460840225,0.19218809902668,0.010251682251691818,-0.3132550120353699,0.0234353207051754,0.24731957912445068,0.23950409889221191,-0.3496299386024475,0.2883845567703247},{-0.2655661702156067,0.08924588561058044,-0.07790262997150421,0.0909486636519432,-0.1764254868030548,-0.31284913420677185,-0.24129296839237213,-0.16414828598499298,-0.13598734140396118,0.21619318425655365,-0.07671155780553818,0.19018690288066864,-0.142003133893013,-0.025948962196707726,-0.05666437745094299,0.27454373240470886},{-0.27535420656204224,0.2004544734954834,0.11688710004091263,-0.13633407652378082,0.12027642875909805,0.15980064868927002,0.05216744542121887,-0.2035602480173111,0.3840501308441162,0.26542797684669495,0.29266947507858276,0.20964562892913818,-0.0817541778087616,-0.23368753492832184,-0.17728984355926514,0.1291876584291458}};
static const float actor_encoder_neighbor_embed_layer_0_bias[16] = {-0.17632564902305603,-0.1683141440153122,0.20304657518863678,0.17050722241401672,-0.3065185844898224,-0.13581395149230957,0.2899211347103119,-0.036132048815488815,0.036423809826374054,0.015619613230228424,0.08046126365661621,0.21433599293231964,-0.3872803747653961,-0.009231479838490486,-0.03646913543343544,0.11347757279872894};
static const float actor_encoder_obstacle_embed_layer_0_weight[9][16] = {{-0.5129746794700623,0.5932689309120178,0.04438026249408722,-0.022532762959599495,0.544765293598175,0.6282472014427185,0.27640342712402344,-0.2656641900539398,-0.3916364908218384,0.47175681591033936,-0.0662214532494545,-0.254524290561676,0.26035287976264954,0.4216691255569458,0.5048432350158691,0.388415664434433},{0.05240239202976227,0.4122639000415802,-0.3135603070259094,0.32807162404060364,0.6285964250564575,0.5235825181007385,0.31711146235466003,-0.05271602049469948,0.28480881452560425,0.34431156516075134,0.24077299237251282,-0.15344129502773285,0.6191027164459229,-0.22252196073532104,0.38731056451797485,-0.522862434387207},{-0.24020525813102722,0.0398605540394783,0.09444200247526169,-0.008566846139729023,0.2410769909620285,-0.12048589438199997,-0.6542938351631165,-0.0973120853304863,0.04603013023734093,-0.702299952507019,0.6020960807800293,-0.2906532883644104,0.4702049791812897,0.25803855061531067,0.283474862575531,0.06327635794878006},{0.3736918270587921,0.21358796954154968,-0.3096338212490082,-0.4749990999698639,0.10254769772291183,0.6403500437736511,-0.19296930730342865,0.2903011441230774,0.027144204825162888,-0.1644289642572403,-0.5178278684616089,-0.44885316491127014,-0.3738763928413391,0.36807507276535034,0.4300411343574524,0.09201644361019135},{0.3173115849494934,-0.05309291183948517,-0.1389344036579132,-0.3041413426399231,0.08222565054893494,-0.02474423311650753,0.17055805027484894,-0.31906452775001526,-0.1449100822210312,-0.3226870000362396,-0.3655757009983063,0.13338808715343475,0.4643983542919159,-0.47315293550491333,0.06841950118541718,-0.25675132870674133},{0.417226642370224,0.2960439920425415,-0.29027536511421204,0.049090638756752014,0.3900647759437561,0.17156384885311127,-0.5293736457824707,0.2779448926448822,0.49943000078201294,-0.5676011443138123,-0.017668595537543297,-0.046235308051109314,-0.09044437855482101,-0.33697986602783203,0.5476096868515015,-0.48933419585227966},{0.32441940903663635,0.05943712964653969,-0.12993718683719635,-0.5032296776771545,-0.5060656666755676,0.11649788171052933,0.10105390101671219,0.8457812070846558,0.21133172512054443,-0.010020224377512932,-0.6962044835090637,-0.6368926763534546,-0.041430357843637466,0.4341184198856354,-0.4558809995651245,0.243302583694458},{0.2990456223487854,0.1906173825263977,-0.5288034081459045,0.008407635614275932,0.2764531672000885,-0.35937562584877014,-0.4461708664894104,-0.11338727176189423,0.12973585724830627,-0.02528121881186962,-0.12880216538906097,0.328736811876297,0.04702389985322952,-0.45992884039878845,-0.5565595626831055,0.2065478414297104},{0.20760974287986755,0.02438131719827652,-0.058584053069353104,0.25061511993408203,-0.04232776537537575,-0.2679844796657562,-0.27658340334892273,0.5682545900344849,0.1701379269361496,-0.34424737095832825,-0.3004666268825531,-0.05782085284590721,0.015450539067387581,-0.6585585474967957,-0.2143198698759079,-0.02777005545794964}};
static const float actor_encoder_obstacle_embed_layer_0_bias[16] = {0.11975056678056717,0.03998815268278122,0.024160193279385567,-0.07986259460449219,0.018568994477391243,0.03889497369527817,-0.01644289307296276,0.046723753213882446,-0.04085399955511093,0.04315894842147827,0.1308164894580841,0.10997740924358368,-0.08802090585231781,0.0006152248824946582,-0.06792131066322327,-0.09682510793209076};
static const float actor_encoder_attention_layer_w_qs_weight[16][16] = {{0.18744686245918274,-0.1873190551996231,-0.15522980690002441,-0.3432779014110565,-0.14802679419517517,0.1955813616514206,0.3502555787563324,-0.5311289429664612,-0.49583736062049866,-0.2844306528568268,-0.13985185325145721,0.0624210387468338,0.14298447966575623,0.06319776177406311,-0.1329425424337387,0.2094036191701889},{0.2376050353050232,-0.2891826033592224,-0.4763566553592682,-0.0009326717699877918,-0.31509315967559814,-0.09541294723749161,0.15144576132297516,0.019945023581385612,-0.23912538588047028,0.2926202416419983,-0.09096068143844604,-0.15543605387210846,0.11776412278413773,0.04008626192808151,-0.3970455825328827,0.24429187178611755},{-0.37331679463386536,0.17469409108161926,-0.20089545845985413,-0.12617984414100647,0.5214816927909851,0.30239951610565186,-0.06242901086807251,0.3007797598838806,0.18404747545719147,0.3020090162754059,0.40639811754226685,-0.22258852422237396,0.09925983101129532,-0.11877258121967316,0.36122122406959534,0.02346586436033249},{-0.45760366320610046,0.4812752306461334,-0.09187600016593933,-0.25038909912109375,-0.2822088599205017,-0.08354122936725616,-0.5050050616264343,-0.04455038160085678,0.20141319930553436,0.3609810173511505,-0.0492195263504982,0.4074705243110657,-0.3928174376487732,0.21584436297416687,-0.14158715307712555,0.27133607864379883},{-0.17764350771903992,-0.18626120686531067,-0.1618175506591797,0.19442051649093628,0.47890257835388184,0.0766303539276123,-0.032382890582084656,0.03170403838157654,0.1060805395245552,-0.5036425590515137,-0.09537223726511002,-0.14294575154781342,0.11037244647741318,0.11877986043691635,-0.19226449728012085,-0.1604401171207428},{-0.21032479405403137,-0.22584810853004456,-0.36035147309303284,0.3719189167022705,0.33249467611312866,0.1589643359184265,-0.44786903262138367,0.05861262232065201,-0.4141368865966797,0.27945736050605774,-0.4320661425590515,-0.43267273902893066,-0.19803133606910706,0.502886176109314,-0.4297439754009247,0.0892995297908783},{-0.04500849172472954,0.24242658913135529,0.1504708230495453,-0.2347680926322937,-0.23671381175518036,0.3120529055595398,-0.3388768434524536,-0.03390943631529808,-0.042123980820178986,-0.16469520330429077,-0.007791448850184679,0.15205273032188416,0.1308971792459488,-0.016070818528532982,0.4834614396095276,-0.055720459669828415},{0.18617840111255646,-0.11214084923267365,-0.2424277663230896,-0.2325841784477234,0.29950305819511414,0.05453634262084961,0.2705598473548889,0.27000364661216736,0.27575787901878357,0.3316546678543091,0.028940485790371895,0.4517589211463928,-0.2685413360595703,0.2759527564048767,0.019701313227415085,-0.02825191430747509},{-0.2642759084701538,-0.2106025069952011,0.10640352964401245,-0.06647942215204239,0.009419442154467106,0.16323789954185486,-0.08994251489639282,0.28941404819488525,0.07348209619522095,-0.13246110081672668,0.5274121761322021,0.2447018325328827,0.4009130001068115,-0.6104006171226501,0.10179325193166733,-0.02337431162595749},{0.4668099582195282,0.05589175596833229,0.1837051659822464,-0.05385885760188103,-0.05352253094315529,0.10565942525863647,0.18776054680347443,0.21856063604354858,0.13211292028427124,-0.008135044015944004,0.08541816473007202,0.0751875638961792,-0.30804046988487244,0.12240450084209442,-0.25716859102249146,0.5484643578529358},{-0.1186920776963234,-0.039092808961868286,0.04914626106619835,-0.3013087511062622,0.07748778909444809,0.3279678523540497,0.2806694507598877,0.11658452451229095,-0.368498295545578,-0.22631195187568665,0.3362264037132263,-0.12070181965827942,-0.1924804151058197,-0.15405568480491638,0.164418026804924,0.03190983086824417},{0.03149625286459923,0.5191162824630737,-0.01632859744131565,0.2866765558719635,0.05994051694869995,-0.03220522031188011,0.007369647268205881,-0.08804687112569809,0.3708409070968628,-0.22955341637134552,-0.5336518287658691,-0.27391600608825684,-0.21540185809135437,0.015020918101072311,-0.3356930613517761,0.016612974926829338},{-0.17941950261592865,-0.1635959893465042,0.11110082268714905,0.4094010293483734,-0.32609379291534424,-0.02587895281612873,-0.1906341314315796,0.1963464766740799,0.09846232086420059,-0.302315890789032,-0.12048791348934174,0.0966673269867897,-0.17204974591732025,-0.07419876754283905,-0.1618940383195877,-0.21685302257537842},{-0.22912369668483734,-0.5080476999282837,-0.2786712348461151,0.30367857217788696,0.40213334560394287,-0.46606865525245667,0.27680787444114685,-0.29031628370285034,0.09793166816234589,0.36295151710510254,0.31057652831077576,0.12590493261814117,0.20424425601959229,-0.30345213413238525,-0.09580446034669876,-0.4385962188243866},{-0.6062291860580444,-0.10561954230070114,-0.12089182436466217,-0.16224661469459534,0.3276291787624359,0.5152992010116577,0.3697075843811035,0.49804118275642395,0.19482895731925964,-0.018480192869901657,0.2815536856651306,-0.35244524478912354,-0.20223252475261688,0.5362858772277832,0.1935688555240631,0.30060988664627075},{0.05115894600749016,0.211984321475029,0.19136229157447815,0.5693679451942444,-0.32773256301879883,-0.25824791193008423,0.08150783181190491,0.07228133827447891,0.24976719915866852,0.06596650928258896,-0.3667338788509369,0.04844921454787254,-0.21316483616828918,0.38753730058670044,-0.21088798344135284,-0.055191587656736374}};
static const float actor_encoder_attention_layer_w_ks_weight[16][16] = {{-0.29018524289131165,-0.0432165153324604,0.2572541832923889,0.1406053751707077,-0.05793963372707367,-0.3477229177951813,0.24792703986167908,0.17086394131183624,-0.13625945150852203,0.2762632668018341,-0.32367515563964844,0.12394733726978302,0.17016586661338806,0.003395159263163805,-0.4785100519657135,-0.4052581787109375},{-0.08104255795478821,-0.09838248789310455,0.1546444147825241,0.044441744685173035,-0.07987529039382935,0.3855453133583069,-0.01409163698554039,0.10247242450714111,-0.06448942422866821,-0.4819395840167999,-0.04744730889797211,-0.4296725392341614,-0.01065058633685112,0.37255117297172546,0.3690476417541504,-0.14823579788208008},{0.3286624848842621,0.46957558393478394,0.25201550126075745,-0.029201773926615715,-0.564484179019928,0.08469764143228531,0.28432339429855347,-0.49779751896858215,0.30347180366516113,0.418386310338974,-0.5140489339828491,0.3914929926395416,-0.387317955493927,-0.09002725034952164,-0.04303503781557083,0.08285979926586151},{0.13344991207122803,-0.008040221408009529,0.38630563020706177,-0.29463428258895874,0.10812931507825851,-0.016570094972848892,0.19673971831798553,-0.4194929003715515,-0.34311267733573914,-0.4456346333026886,-0.09928756952285767,-0.21680767834186554,0.08995001018047333,-0.25244367122650146,-0.05657583475112915,0.14006072282791138},{0.3729747235774994,0.034211769700050354,-0.19291335344314575,-0.1834021955728531,-0.22683411836624146,0.11530007421970367,0.28508421778678894,-0.3793720602989197,-0.2556712031364441,0.26104581356048584,-0.6015023589134216,0.20337097346782684,-0.003590842243283987,-0.1672881543636322,-0.5140442252159119,-0.3183421790599823},{0.39478588104248047,-0.424525648355484,0.11121944338083267,-0.2158217877149582,0.242628276348114,0.06775873154401779,0.3160780668258667,-0.36590325832366943,-0.008340353146195412,-0.012151897884905338,-0.02504185400903225,0.23091229796409607,-0.10596262663602829,-0.3937535285949707,0.05067972466349602,0.22785240411758423},{0.05222078040242195,-0.044924069195985794,0.40023088455200195,0.4475860297679901,-0.17851829528808594,0.06742295622825623,-0.34386298060417175,0.363312304019928,0.3359929323196411,0.13786403834819794,-0.1348945051431656,-0.3831497132778168,-0.32290270924568176,-0.06015728786587715,-0.40781155228614807,-0.05274578556418419},{-0.29091617465019226,-0.3580658733844757,-0.1987561732530594,0.32052111625671387,0.5119132995605469,0.19379663467407227,-0.4716334939002991,-0.0822053924202919,0.040575750172138214,0.0501367561519146,-0.24976612627506256,-0.26404210925102234,0.08109297603368759,-0.02643493562936783,0.1720445603132248,-0.006207556463778019},{0.01198258064687252,0.04264019802212715,0.20895132422447205,0.24291545152664185,-0.11330031603574753,-0.00262184115126729,-0.0881543904542923,-0.3400647044181824,0.1275327503681183,-0.446491003036499,-0.5449124574661255,-0.3020954132080078,-0.5072261095046997,0.6050440669059753,0.09351380914449692,0.27336403727531433},{0.1730298399925232,-0.08905044198036194,0.4170738458633423,-0.34443968534469604,-0.09780211746692657,-0.26959294080734253,-0.11503644287586212,-0.0035071936435997486,0.053865548223257065,0.49888235330581665,-0.21475714445114136,0.07939126342535019,-0.02479463629424572,-0.2132854014635086,0.5459755063056946,-0.4355579912662506},{0.055106841027736664,0.4631146788597107,-0.0012320149689912796,-0.010980878956615925,0.10007381439208984,-0.08865787088871002,-0.24399276077747345,-0.03856086730957031,0.1952778697013855,0.04090546816587448,-0.02322821132838726,0.34587347507476807,0.1395629197359085,-0.40464380383491516,0.4637562930583954,0.15138660371303558},{-0.42148372530937195,-0.2238398790359497,0.2816137373447418,-0.4661964476108551,0.2846512496471405,0.17182938754558563,-0.05626942589879036,-0.1041773110628128,0.1614840179681778,0.4693368375301361,0.30364033579826355,0.43722203373908997,-0.11920682340860367,0.33994489908218384,-0.09166561812162399,-0.07164237648248672},{0.024516021832823753,-0.3405124843120575,-0.09322395920753479,0.019911760464310646,0.2956956624984741,-0.42495208978652954,0.11578507721424103,-0.470367431640625,-0.1573294997215271,0.016845691949129105,0.032474085688591,-0.035539332777261734,0.0610162615776062,-0.07045385241508484,-0.27878066897392273,0.12643329799175262},{0.05059830844402313,0.07467202097177505,-0.07576020061969757,0.17955565452575684,0.21135972440242767,0.20566639304161072,0.4394426941871643,0.13080976903438568,0.0520634800195694,-0.18279650807380676,-0.10812735557556152,-0.2687673270702362,-0.14488963782787323,0.44328632950782776,0.31015026569366455,0.504003643989563},{0.28440985083580017,-0.2974286675453186,0.12903980910778046,0.47043120861053467,-0.42312121391296387,-0.3802834749221802,0.1232064887881279,-0.05719452351331711,0.421869695186615,0.26656025648117065,0.21198101341724396,-0.06159061938524246,0.31581565737724304,-0.07067682594060898,0.1733350157737732,-0.3525065779685974},{0.40386199951171875,-0.3126929998397827,-0.15845246613025665,-0.24633334577083588,0.3840954303741455,0.3179115355014801,0.2209654003381729,-0.20692409574985504,0.12461844086647034,-0.04122430458664894,-0.229557067155838,0.04002811014652252,-0.07083570212125778,-0.09249839931726456,0.45905601978302,-0.3521844744682312}};
static const float actor_encoder_attention_layer_w_vs_weight[16][16] = {{-0.23347413539886475,0.11790899932384491,-0.4167896509170532,-0.11871366947889328,-0.09489914029836655,0.3031255304813385,0.12756653130054474,0.25523969531059265,-0.47333234548568726,0.20753821730613708,0.3571515381336212,-0.37390655279159546,0.1168675571680069,-0.051566991955041885,0.081357941031456,-0.0029211563523858786},{0.2195443958044052,0.01338996458798647,-0.2810437083244324,0.23336148262023926,-0.4100397825241089,0.16713738441467285,-0.055705584585666656,0.17964990437030792,0.3007809519767761,-0.2696957290172577,0.2518896162509918,0.16054832935333252,-0.3906232416629791,-0.44017526507377625,-0.17913326621055603,0.10560008138418198},{-0.022965867072343826,0.2996470034122467,0.13730478286743164,-0.32756590843200684,0.32903599739074707,-0.12598802149295807,0.009876744821667671,-0.02344660460948944,-0.18633536994457245,0.3397611677646637,0.18052701652050018,0.3397733271121979,-0.45793893933296204,-0.10016776621341705,0.21793296933174133,0.14574867486953735},{-0.3785066306591034,-0.04749622195959091,0.16805970668792725,0.3539028465747833,-0.16419115662574768,-0.38111403584480286,0.038719139993190765,-0.0941675677895546,0.15828809142112732,-0.060666315257549286,-0.0747428759932518,-0.06651964038610458,-0.14746813476085663,-0.4147229790687561,-0.16955995559692383,-0.20524443686008453},{0.4328506886959076,-0.4642440676689148,-0.2891548275947571,0.0202828049659729,-0.06890828162431717,0.11355853825807571,0.0028172587044537067,0.2044532299041748,0.3709472715854645,0.2298601269721985,0.1027064099907875,-0.2312716692686081,0.12214761227369308,0.1070309579372406,0.2635023295879364,-0.27722787857055664},{0.22339209914207458,-0.37527385354042053,-0.49819648265838623,-0.05356103554368019,0.1623983234167099,-0.06534475833177567,-0.22333048284053802,0.15401776134967804,-0.2972675561904907,-0.0059809694066643715,-0.21531669795513153,0.2855431139469147,-0.07239556312561035,0.008014529012143612,0.08629605919122696,0.16202786564826965},{0.06376658380031586,0.5212518572807312,0.38653117418289185,0.3779011368751526,0.17551875114440918,0.37265029549598694,-0.24135220050811768,-0.19105663895606995,-0.13881616294384003,0.15997374057769775,-0.005838647950440645,-0.08284495025873184,-0.04617026448249817,-0.1880529671907425,0.30722320079803467,-0.2496827244758606},{-0.017584621906280518,-0.1481829136610031,-0.16763313114643097,-0.02274129167199135,-0.3462367355823517,-0.3670775294303894,0.26278939843177795,0.3654942214488983,0.17202620208263397,-0.2207842916250229,-0.06572211533784866,-0.34208032488822937,-0.29889625310897827,-0.12357017397880554,-0.173871248960495,0.38207873702049255},{0.032177187502384186,-0.2875935733318329,-0.30358850955963135,-0.2886548340320587,0.039399463683366776,0.08411725610494614,-0.3775637447834015,0.056854698807001114,-0.19381237030029297,-0.0593491792678833,-0.4445525109767914,-0.2856445610523224,0.374606192111969,0.10873886942863464,-0.2989671528339386,0.08170456439256668},{0.4724259376525879,0.503058910369873,0.18307313323020935,-0.21589459478855133,0.496852308511734,0.0995216891169548,0.21022692322731018,-0.20384305715560913,-0.1470647007226944,-0.2694493234157562,0.30574700236320496,0.31985586881637573,-0.3370068371295929,-0.12197897583246231,-0.40286150574684143,-0.11071857064962387},{0.1425933688879013,-0.35329142212867737,-0.19682349264621735,0.12746502459049225,-0.18138103187084198,0.021436531096696854,-0.22161152958869934,-0.29202234745025635,-0.37337061762809753,-0.18909652531147003,-0.07664461433887482,0.3776077628135681,0.05968698859214783,0.11878668516874313,-0.24225537478923798,0.31362637877464294},{0.04721678048372269,0.4109193980693817,-0.03051004745066166,-0.10970409214496613,0.30980005860328674,-0.18868890404701233,-0.05282757803797722,0.022392310202121735,0.06395934522151947,-0.16843141615390778,0.35485410690307617,0.3465660810470581,-0.2651654779911041,-0.2813382148742676,-0.29580965638160706,0.021911270916461945},{0.16936437785625458,0.22842861711978912,-0.19628563523292542,0.18235817551612854,0.29433172941207886,0.28004664182662964,0.29618382453918457,-0.1685170978307724,0.2787458300590515,0.2667299509048462,0.14413140714168549,-0.33932971954345703,0.4170427918434143,0.15438495576381683,0.15565721690654755,-0.3708093762397766},{0.1749849021434784,-0.01960434764623642,0.3326994776725769,-0.30276644229888916,0.14976581931114197,-0.35228830575942993,-0.15810303390026093,-0.36556729674339294,0.09240803867578506,0.15641282498836517,-0.25405192375183105,0.19895105063915253,0.3509359061717987,-0.269180566072464,-0.25927141308784485,-0.3424166738986969},{-0.15689226984977722,0.20210044085979462,0.06861848384141922,-0.2892981469631195,-0.4551154375076294,0.08527195453643799,-0.23514068126678467,0.2333143949508667,-0.09979607909917831,0.134689062833786,0.1389535367488861,0.07198719680309296,-0.18002477288246155,-0.443980872631073,-0.013659321703016758,-0.4275943636894226},{0.19819040596485138,0.3880712389945984,0.3755505681037903,0.331575483083725,0.34133225679397583,-0.245666965842247,0.15981055796146393,0.2789858877658844,0.3676711320877075,0.23792588710784912,-0.144806906580925,0.02361481636762619,0.270720511674881,0.1297256201505661,-0.11817757785320282,-0.3862400949001312}};
static const float actor_encoder_attention_layer_fc_weight[16][16] = {{0.28074824810028076,-0.25865864753723145,-0.23109334707260132,-0.14806970953941345,-0.18236756324768066,-0.21362124383449554,-0.5057423710823059,-0.09768489748239517,0.18894559144973755,0.24677637219429016,0.14356619119644165,-0.256236732006073,0.19776660203933716,0.38113313913345337,-0.02096530795097351,-0.3737714886665344},{0.20916016399860382,0.4682517349720001,-0.24233731627464294,-0.21227715909481049,-0.08831984549760818,0.21762754023075104,0.09149365872144699,-0.4519713819026947,0.2997346520423889,0.3188026249408722,-0.1796151101589203,0.49048590660095215,-0.4381997287273407,0.042025718837976456,0.26457077264785767,-0.07200934737920761},{0.2003410905599594,-0.24540412425994873,-0.056257665157318115,0.34568336606025696,-0.10183349251747131,-0.15739759802818298,-0.05091200768947601,-0.4058017432689667,-0.08956906944513321,-0.08009722083806992,-0.21853968501091003,0.25343620777130127,-0.5622772574424744,0.06272812932729721,-0.2528745234012604,-0.10244115442037582},{-0.40487825870513916,0.006616466678678989,0.06429961323738098,-0.42851486802101135,-0.3173065781593323,0.002035579876974225,-0.217767134308815,0.033014826476573944,0.2866649031639099,0.359558641910553,0.1201891079545021,0.3047354519367218,-0.01732828840613365,-0.27754876017570496,0.3817193806171417,-0.205397367477417},{0.319011926651001,0.12358745187520981,-0.049419816583395004,-0.11729893088340759,-0.07952015846967697,-0.03337899222970009,0.3139888644218445,-0.07198107242584229,0.22078698873519897,-0.3467986285686493,0.35425901412963867,0.22630545496940613,0.016441019251942635,0.46166858077049255,0.055740322917699814,0.06475452333688736},{0.42405253648757935,0.009338702075183392,0.04224986582994461,-0.07941913604736328,-0.14922769367694855,0.2890442907810211,0.01284969411790371,0.31951239705085754,-0.23378393054008484,-0.19522936642169952,-0.25548067688941956,-0.08360356092453003,0.42678019404411316,-0.02281085029244423,0.2883544862270355,-0.40245845913887024},{0.1646231859922409,0.1918313354253769,-0.004473879933357239,-0.09496825188398361,-0.11448643356561661,-0.01982477307319641,-0.1919960379600525,0.24452592432498932,0.06980279088020325,-0.050214894115924835,0.3750501871109009,-0.20409804582595825,0.155134379863739,-0.05928239971399307,0.17236250638961792,-0.021300293505191803},{-0.20610198378562927,0.013852984644472599,-0.4059077203273773,0.16899949312210083,-0.17141583561897278,0.1870860606431961,0.30813175439834595,0.4928256571292877,0.1883111298084259,-0.26326167583465576,0.12085753679275513,-0.41252726316452026,0.3972557783126831,-0.04002707824110985,-0.40354374051094055,0.0037895124405622482},{-0.3557467460632324,0.12801499664783478,0.054568421095609665,0.3930905759334564,-0.21908996999263763,-0.07647884637117386,0.061192888766527176,0.14494098722934723,0.17316317558288574,0.01046819519251585,-0.2567254900932312,-0.219358429312706,-0.17035144567489624,0.17447581887245178,0.24977557361125946,0.26636558771133423},{0.37365102767944336,-0.30477175116539,-0.0033636221196502447,0.2604893743991852,0.3444743752479553,0.4617505371570587,-0.2742331027984619,-0.2815453112125397,0.461385577917099,0.003975979518145323,0.20865720510482788,-0.3552757203578949,0.09659568965435028,-0.08736544847488403,-0.24410884082317352,-0.1637953817844391},{0.0397578701376915,-0.05919157713651657,-0.2619471848011017,-0.21823400259017944,-0.22661717236042023,0.0235113687813282,-0.01645147241652012,-0.06466379761695862,-0.19266311824321747,0.3848370909690857,0.44380879402160645,0.4249000549316406,0.3336491286754608,-0.28851258754730225,-0.3282223641872406,-0.4342702627182007},{0.10201231390237808,0.1778460294008255,-0.3947996199131012,-0.27488598227500916,0.3455064594745636,0.16408583521842957,-0.3265657126903534,-0.4111490249633789,0.032817237079143524,-0.1376638114452362,-0.010786366648972034,0.01915169693529606,-0.489629864692688,-0.09512881934642792,0.16682158410549164,-0.07131851464509964},{0.02416059374809265,0.266434907913208,0.1056569367647171,0.16369867324829102,-0.22606724500656128,0.007434006780385971,-0.30642083287239075,0.006041275337338448,0.30646711587905884,0.28661003708839417,0.2823448181152344,-0.16312795877456665,0.4421249032020569,0.10122985392808914,0.08600061386823654,0.3284340798854828},{0.27782222628593445,-0.48660123348236084,-0.09157642722129822,0.326401948928833,-0.16629575192928314,-0.2658895254135132,0.011871042661368847,0.23408842086791992,-0.35648980736732483,0.05845870077610016,-0.07642562687397003,-0.0128600113093853,-0.2715044915676117,0.00579919945448637,-0.11249589174985886,-0.2992669343948364},{-0.4216656982898712,-0.2652418613433838,0.08381877094507217,-0.3109956681728363,0.11199140548706055,0.3029794692993164,0.08839470893144608,0.11543671786785126,-0.14747285842895508,0.4192337393760681,-0.32560673356056213,0.2622363865375519,0.3508799970149994,-0.10224945098161697,-0.20295429229736328,0.2615969479084015},{0.17524725198745728,-0.19164304435253143,-0.07990383356809616,-0.17898376286029816,0.10424792766571045,-0.3642635941505432,-0.05388787016272545,0.1838909238576889,0.22069013118743896,-0.15169596672058105,-0.3008778989315033,0.10284344106912613,0.10151927918195724,0.016978630796074867,0.425064355134964,0.3104366958141327}};
static const float actor_encoder_attention_layer_layer_norm_weight[16] = {0.7551530599594116,0.6635320782661438,0.6382948160171509,0.7271143794059753,0.5849101543426514,0.7547528147697449,0.6620011329650879,0.7932880520820618,0.6322534680366516,0.76910799741745,0.7402342557907104,0.7196693420410156,0.7639042139053345,0.788803219795227,0.8502594232559204,0.7449755072593689};
static const float actor_encoder_attention_layer_layer_norm_bias[16] = {0.12335444241762161,-0.020812436938285828,0.008719165809452534,-0.02022523619234562,0.041993916034698486,-0.05018563196063042,0.004837328102439642,-0.12191049009561539,0.026647493243217468,0.03280119597911835,-0.028995180502533913,0.1829199492931366,-0.07137516140937805,0.04891728609800339,0.021874766796827316,0.07628851383924484};
void networkEvaluate(struct control_t_n *control_n, const float *state_array) {
        // Self embed layer
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_0[i] = 0;
            for (int j = 0; j < self_structure[0][0]; j++) {
                output_0[i] += state_array[j] * actor_encoder_self_embed_layer_0_weight[j][i];
            }
            output_0[i] += actor_encoder_self_embed_layer_0_bias[i];
            output_0[i] = tanhf(output_0[i]);
        }
    
        // Concat self_embed, neighbor_embed and obst_embed
        for (int i = 0; i < self_structure[0][1]; i++) {
            output_embeds[i] = output_0[i];
            output_embeds[i + self_structure[0][1]] = attn_embeds[0][i];
            output_embeds[i + 2 * self_structure[0][1]] = attn_embeds[1][i];
        }
    
        // Feedforward layer
        for (int i = 0; i < self_structure[1][1]; i++) {
            output_1[i] = 0;
            for (int j = 0; j < 3 * self_structure[0][1]; j++) {
                output_1[i] += output_embeds[j] * actor_encoder_feed_forward_0_weight[j][i];
                }
            output_1[i] += actor_encoder_feed_forward_0_bias[i];
            output_1[i] = tanhf(output_1[i]);
        }
    
        for (int i = 0; i < self_structure[2][1]; i++) {
            output_2[i] = 0;
            for (int j = 0; j < self_structure[2][0]; j++) {
                output_2[i] += output_1[j] * action_parameterization_distribution_linear_weight[j][i];
            }
            output_2[i] += action_parameterization_distribution_linear_bias[i];
        }
        
        control_n->thrust_0 = output_2[0];
        control_n->thrust_1 = output_2[1];
        control_n->thrust_2 = output_2[2];
        control_n->thrust_3 = output_2[3];	
    }

void neighborEmbedder(const float neighbor_inputs[NEIGHBORS * NBR_DIM]) {
    
            for (int i = 0; i < nbr_structure[0][1]; i++) {
                nbr_output_0[i] = 0; 
                for (int j = 0; j < nbr_structure[0][0]; j++) {
                    nbr_output_0[i] += neighbor_inputs[j] * actor_encoder_neighbor_embed_layer_0_weight[j][i]; 
                }
                nbr_output_0[i] += actor_encoder_neighbor_embed_layer_0_bias[i];
                nbr_output_0[i] = tanhf(nbr_output_0[i]);
            }
    }

void obstacleEmbedder(const float obstacle_inputs[OBST_DIM]) {
        //reset embeddings accumulator to zero
        memset(obstacle_embeds, 0, sizeof(obstacle_embeds));
        
    
        for (int i = 0; i < obst_structure[0][1]; i++) {
            obst_output_0[i] = 0;
            for (int j = 0; j < obst_structure[0][0]; j++) {
                obst_output_0[i] += obstacle_inputs[j] * actor_encoder_obstacle_embed_layer_0_weight[j][i];
            }
            obst_output_0[i] += actor_encoder_obstacle_embed_layer_0_bias[i];
            obst_output_0[i] = tanhf(obst_output_0[i]);
        }
    }


void singleHeadAttention() {
        uint8_t i, j, k;
        // fill the tokens matrix with obstacle and neighbor embeddings
        for (i = 0; i < D_MODEL; i++) {
            tokens[0][i] = nbr_output_0[i];
            tokens[1][i] = obst_output_0[i];
        }
        
        // save the residual
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                residual[i][j] = tokens[i][j];
            }
        }
        
        // compute Q, K, V projection 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                q_outputs[i][j] = 0;
                k_outputs[i][j] = 0;
                v_outputs[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    q_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_qs_weight[k][j]; 
                    k_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_ks_weight[k][j];
                    v_outputs[i][j] += tokens[i][k] * actor_encoder_attention_layer_w_vs_weight[k][j];
                }
            }
        }
        
        // compute attention weights and parts of softmax
        for (i = 0; i < NUM_TOKENS; i++) {
            softmax_sums[i] = 0;
            for (int j = 0; j < NUM_TOKENS; j++) {
                attn_weights[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    attn_weights[i][j] += (q_outputs[i][k] / sqrt((float)D_MODEL)) * k_outputs[j][k];
                }
                softmax_sums[i] += exp(attn_weights[i][j]);
            }
        }
        
        // softmax
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < NUM_TOKENS; j++) {
                attn_weights[i][j] = exp(attn_weights[i][j]) / softmax_sums[i];
            }
        }

        // compute query 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                query_output[i][j] = 0;
                for (k = 0; k < NUM_TOKENS; k++) {
                    query_output[i][j] += attn_weights[i][k] * v_outputs[k][j];
                }
            }
        }
        
        // compute the q embeddings 
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                query_embeds[i][j] = 0;
                for (k = 0; k < D_MODEL; k++) {
                    query_embeds[i][j] += query_output[i][k] * actor_encoder_attention_layer_fc_weight[k][j];
                }
                // add the residual
                query_embeds[i][j] += residual[i][j];
            }
        }
        
        // calculate per-token mean
        for (i = 0; i < NUM_TOKENS; i++){
            last_layer_means[i] = 0;
            for (j = 0; j < D_MODEL; j++) {
                last_layer_means[i] +=  query_embeds[i][j];
            }
            last_layer_means[i] = last_layer_means[i] / (float)D_MODEL;
        }
        
        // calculate per-token variance
        for (i = 0; i < NUM_TOKENS; i++) {
            last_layer_variances[i] = 0;
            for (j = 0; j < D_MODEL; j++) {
                base = query_embeds[i][j] - last_layer_means[i];
                exponent = pow(base, 2);
                last_layer_variances[i] += exponent;
            }
            last_layer_variances[i] = last_layer_variances[i] / (float)(D_MODEL);
        }
        
        // perform layer norm (2x16) x (16)
        for (i = 0; i < NUM_TOKENS; i++) {
            for (j = 0; j < D_MODEL; j++) {
                attn_embeds[i][j] = (query_embeds[i][j] - last_layer_means[i]) / (sqrt(last_layer_variances[i] + EPS)) * actor_encoder_attention_layer_layer_norm_weight[j]; 
                attn_embeds[i][j] += actor_encoder_attention_layer_layer_norm_bias[j]; 
            }
        }
}
